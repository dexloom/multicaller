// SPDX-License-Identifier: Unlicense
pragma solidity ^0.8.15;

import "foundry-huff/HuffDeployer.sol";
import "forge-std/Test.sol";
import "forge-std/console.sol";

import "../src/ERC20.sol";
import "../src/interfaces/dydx/ISoloMargin.sol";
import "./Interface.sol";
import "./Helper.sol";

contract MulticallerSwapStep3Test is Test, TestHelper {
    string[16] testname = [
        "1 UniswapV3Like UniswapV3Like UniswapV3Like",
        "2 UniswapV3Like UniswapV3Like UniswapV3Like",
        "1 UniswapV3Like UniswapV3Like UniswapV2Like",
        "2 UniswapV3Like UniswapV3Like UniswapV2Like",
        "1 UniswapV3Like UniswapV2Like UniswapV3Like",
        "2 UniswapV3Like UniswapV2Like UniswapV3Like",
        "1 UniswapV3Like UniswapV2Like UniswapV2Like",
        "2 UniswapV3Like UniswapV2Like UniswapV2Like",
        "1 UniswapV2Like UniswapV3Like UniswapV3Like",
        "2 UniswapV2Like UniswapV3Like UniswapV3Like",
        "1 UniswapV2Like UniswapV3Like UniswapV2Like",
        "2 UniswapV2Like UniswapV3Like UniswapV2Like",
        "1 UniswapV2Like UniswapV2Like UniswapV3Like",
        "2 UniswapV2Like UniswapV2Like UniswapV3Like",
        "1 UniswapV2Like UniswapV2Like UniswapV2Like",
        "2 UniswapV2Like UniswapV2Like UniswapV2Like"
    ];

    bytes[16] callsdata = [
        bytes(
            hex"28472417000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000003647ffc000000000000000003448ad599c3a0ff1de082011efddc58f1908eb6e6d8128acb0800000000000000000000000078787878787878787878787878787878787878780000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016345785d8a0000000000000000000000000000fffd8963efd1fc6a506488495d951d5263988d2500000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000027b7ffc000082002002006400e47858e59e0c01ea06df3af3d20ac7b0003275d4bf128acb0800000000000000000000000078787878787878787878787878787878787878780000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000276a400000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000014a0b86991c6218b36c1d19d4a2e9eb0ce3606eb480000000000000000000000007ffb00000000000000000003082a007ffc000082000082006400e411b815efb8f581194ae79006d24e0d814b7697f6128acb08000000000000000000000000787878787878787878787878787878787878787800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fffd8963efd1fc6a506488495d951d5263988d2500000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000014dac17f958d2ee523a2206206994597c13d831ec70000000000000000000000007ffc00000000000000000044c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2a9059cbb0000000000000000000000008ad599c3a0ff1de082011efddc58f1908eb6e6d8000000000000000000000000000000000000000000000000016345785d8a0000000000000000000000000000000000000000000000000000000000000000000000"
        ),
        bytes(
            hex"28472417000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000003c47ffc000000000000000003a48ad599c3a0ff1de082011efddc58f1908eb6e6d8128acb0800000000000000000000000078787878787878787878787878787878787878780000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016345785d8a0000000000000000000000000000fffd8963efd1fc6a506488495d951d5263988d2500000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000002c87ffc000000000002006402447858e59e0c01ea06df3af3d20ac7b0003275d4bf128acb0800000000000000000000000078787878787878787878787878787878787878780000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000276a400000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001687ffc000082000002006400e411b815efb8f581194ae79006d24e0d814b7697f6128acb08000000000000000000000000787878787878787878787878787878787878787800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fffd8963efd1fc6a506488495d951d5263988d2500000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000014dac17f958d2ee523a2206206994597c13d831ec70000000000000000000000007ffc00000000001200440044a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48a9059cbb0000000000000000000000007858e59e0c01ea06df3af3d20ac7b0003275d4bf00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007ffc00000000000000000044c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2a9059cbb0000000000000000000000008ad599c3a0ff1de082011efddc58f1908eb6e6d8000000000000000000000000000000000000000000000000016345785d8a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        ),
        bytes(
            hex"28472417000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000003847ffc000000000000000003648ad599c3a0ff1de082011efddc58f1908eb6e6d8128acb0800000000000000000000000078787878787878787878787878787878787878780000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016345785d8a0000000000000000000000000000fffd8963efd1fc6a506488495d951d5263988d2500000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000028b7ffc000082002002006400e47858e59e0c01ea06df3af3d20ac7b0003275d4bf128acb080000000000000000000000000d4a11d5eeaac28ec3f61d100daf4d40471f18520000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000276a400000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000014a0b86991c6218b36c1d19d4a2e9eb0ce3606eb480000000000000000000000007ffb00000000000000000003082a007ffd0000000000820030004495b661620000000000000000000000000d4a11d5eeaac28ec3f61d100daf4d40471f185200000000000000000000000000000000000000000000000000000000000000007ffc000000000082002400a40d4a11d5eeaac28ec3f61d100daf4d40471f1852022c0d9f000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000007878787878787878787878787878787878787878000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000007ffc00000000000000000044c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2a9059cbb0000000000000000000000008ad599c3a0ff1de082011efddc58f1908eb6e6d8000000000000000000000000000000000000000000000000016345785d8a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        ),
        bytes(
            hex"28472417000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000003c47ffc000000000000000003a48ad599c3a0ff1de082011efddc58f1908eb6e6d8128acb0800000000000000000000000078787878787878787878787878787878787878780000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016345785d8a0000000000000000000000000000fffd8963efd1fc6a506488495d951d5263988d2500000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000002c87ffc000000000002006402447858e59e0c01ea06df3af3d20ac7b0003275d4bf128acb080000000000000000000000000d4a11d5eeaac28ec3f61d100daf4d40471f18520000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000276a400000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001787ffd0000000000020030004495b661620000000000000000000000000d4a11d5eeaac28ec3f61d100daf4d40471f185200000000000000000000000000000000000000000000000000000000000000007ffc000000000082002400a40d4a11d5eeaac28ec3f61d100daf4d40471f1852022c0d9f000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000007878787878787878787878787878787878787878000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000007ffc00000000001200440044a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48a9059cbb0000000000000000000000007858e59e0c01ea06df3af3d20ac7b0003275d4bf000000000000000000000000000000000000000000000000000000000000000000000000000000007ffc00000000000000000044c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2a9059cbb0000000000000000000000008ad599c3a0ff1de082011efddc58f1908eb6e6d8000000000000000000000000000000000000000000000000016345785d8a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        ),
        bytes(
            hex"28472417000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000003647ffc000000000000000003448ad599c3a0ff1de082011efddc58f1908eb6e6d8128acb080000000000000000000000003041cbd36888becc7bbcbc0045e3b1f144466f5f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016345785d8a0000000000000000000000000000fffd8963efd1fc6a506488495d951d5263988d2500000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000027c7ffd0000000000020030004484f16ca00000000000000000000000003041cbd36888becc7bbcbc0045e3b1f144466f5f00000000000000000000000000000000000000000000000000000000000000007ffc000000000082004400a43041cbd36888becc7bbcbc0045e3b1f144466f5f022c0d9f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000007878787878787878787878787878787878787878000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000007ffc000082000082006400e411b815efb8f581194ae79006d24e0d814b7697f6128acb08000000000000000000000000787878787878787878787878787878787878787800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fffd8963efd1fc6a506488495d951d5263988d2500000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000014dac17f958d2ee523a2206206994597c13d831ec70000000000000000000000007ffc00000000000000000044c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2a9059cbb0000000000000000000000008ad599c3a0ff1de082011efddc58f1908eb6e6d8000000000000000000000000000000000000000000000000016345785d8a00000000000000000000000000000000000000000000000000000000000000000000"
        ),
        bytes(
            hex"28472417000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000003847ffc000000000000000003648ad599c3a0ff1de082011efddc58f1908eb6e6d8128acb080000000000000000000000003041cbd36888becc7bbcbc0045e3b1f144466f5f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016345785d8a0000000000000000000000000000fffd8963efd1fc6a506488495d951d5263988d2500000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000002987ffd0000000000020030004484f16ca00000000000000000000000003041cbd36888becc7bbcbc0045e3b1f144466f5f00000000000000000000000000000000000000000000000000000000000000007ffc000000000082004401c43041cbd36888becc7bbcbc0045e3b1f144466f5f022c0d9f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007878787878787878787878787878787878787878000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000001047ffc000082000002006400e411b815efb8f581194ae79006d24e0d814b7697f6128acb08000000000000000000000000787878787878787878787878787878787878787800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fffd8963efd1fc6a506488495d951d5263988d2500000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000014dac17f958d2ee523a2206206994597c13d831ec7000000000000000000000000000000000000000000000000000000000000000000000000000000007ffc00000000000000000044c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2a9059cbb0000000000000000000000008ad599c3a0ff1de082011efddc58f1908eb6e6d8000000000000000000000000000000000000000000000000016345785d8a0000000000000000000000000000000000000000000000000000000000000000000000000000"
        ),
        bytes(
            hex"28472417000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000003847ffc000000000000000003648ad599c3a0ff1de082011efddc58f1908eb6e6d8128acb080000000000000000000000003041cbd36888becc7bbcbc0045e3b1f144466f5f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016345785d8a0000000000000000000000000000fffd8963efd1fc6a506488495d951d5263988d2500000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000028c7ffd0000000000020030004484f16ca00000000000000000000000003041cbd36888becc7bbcbc0045e3b1f144466f5f00000000000000000000000000000000000000000000000000000000000000007ffc000000000082004400a43041cbd36888becc7bbcbc0045e3b1f144466f5f022c0d9f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000d4a11d5eeaac28ec3f61d100daf4d40471f1852000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000007ffd0000000000820030004495b661620000000000000000000000000d4a11d5eeaac28ec3f61d100daf4d40471f185200000000000000000000000000000000000000000000000000000000000000007ffc000000000082002400a40d4a11d5eeaac28ec3f61d100daf4d40471f1852022c0d9f000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000007878787878787878787878787878787878787878000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000007ffc00000000000000000044c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2a9059cbb0000000000000000000000008ad599c3a0ff1de082011efddc58f1908eb6e6d8000000000000000000000000000000000000000000000000016345785d8a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        ),
        bytes(
            hex"28472417000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000003e47ffc000000000000000003c48ad599c3a0ff1de082011efddc58f1908eb6e6d8128acb080000000000000000000000003041cbd36888becc7bbcbc0045e3b1f144466f5f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016345785d8a0000000000000000000000000000fffd8963efd1fc6a506488495d951d5263988d2500000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000002f87ffd0000000000020030004484f16ca00000000000000000000000003041cbd36888becc7bbcbc0045e3b1f144466f5f00000000000000000000000000000000000000000000000000000000000000007ffc000000000082004402243041cbd36888becc7bbcbc0045e3b1f144466f5f022c0d9f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007878787878787878787878787878787878787878000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000001787ffc00000000000200440044dac17f958d2ee523a2206206994597c13d831ec7a9059cbb0000000000000000000000000d4a11d5eeaac28ec3f61d100daf4d40471f185200000000000000000000000000000000000000000000000000000000000000007ffd0000000000020030004495b661620000000000000000000000000d4a11d5eeaac28ec3f61d100daf4d40471f185200000000000000000000000000000000000000000000000000000000000000007ffc000000000082002400a40d4a11d5eeaac28ec3f61d100daf4d40471f1852022c0d9f0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000078787878787878787878787878787878787878780000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000007ffc00000000000000000044c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2a9059cbb0000000000000000000000008ad599c3a0ff1de082011efddc58f1908eb6e6d8000000000000000000000000000000000000000000000000016345785d8a0000000000000000000000000000000000000000000000000000000000000000000000000000"
        ),
        bytes(
            hex"28472417000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000003947ffd0000000000000000004495b66162000000000000000000000000b4e16d0168e52d35cacd2c6185b44281ec28c9dc000000000000000000000000000000000000000000000000016345785d8a00007ffc00000000008200240324b4e16d0168e52d35cacd2c6185b44281ec28c9dc022c0d9f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000078787878787878787878787878787878787878780000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000027b7ffc000082002002006400e47858e59e0c01ea06df3af3d20ac7b0003275d4bf128acb0800000000000000000000000078787878787878787878787878787878787878780000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000276a400000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000014a0b86991c6218b36c1d19d4a2e9eb0ce3606eb480000000000000000000000007ffb00000000000000000003082a007ffc000082000082006400e411b815efb8f581194ae79006d24e0d814b7697f6128acb08000000000000000000000000787878787878787878787878787878787878787800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fffd8963efd1fc6a506488495d951d5263988d2500000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000014dac17f958d2ee523a2206206994597c13d831ec70000000000000000000000007ffc00000000000000000044c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2a9059cbb000000000000000000000000b4e16d0168e52d35cacd2c6185b44281ec28c9dc000000000000000000000000000000000000000000000000016345785d8a00000000000000000000000000000000000000"
        ),
        bytes(
            hex"28472417000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000003f47ffd0000000000000000004495b66162000000000000000000000000b4e16d0168e52d35cacd2c6185b44281ec28c9dc000000000000000000000000000000000000000000000000016345785d8a00007ffc00000000008200240384b4e16d0168e52d35cacd2c6185b44281ec28c9dc022c0d9f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007878787878787878787878787878787878787878000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000002c87ffc000000000002006402447858e59e0c01ea06df3af3d20ac7b0003275d4bf128acb0800000000000000000000000078787878787878787878787878787878787878780000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000276a400000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001687ffc000082000002006400e411b815efb8f581194ae79006d24e0d814b7697f6128acb08000000000000000000000000787878787878787878787878787878787878787800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fffd8963efd1fc6a506488495d951d5263988d2500000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000014dac17f958d2ee523a2206206994597c13d831ec70000000000000000000000007ffc00000000001200440044a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48a9059cbb0000000000000000000000007858e59e0c01ea06df3af3d20ac7b0003275d4bf00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007ffc00000000000000000044c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2a9059cbb000000000000000000000000b4e16d0168e52d35cacd2c6185b44281ec28c9dc000000000000000000000000000000000000000000000000016345785d8a0000000000000000000000000000000000000000000000000000000000000000000000000000"
        ),
        bytes(
            hex"28472417000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000003b47ffd0000000000000000004495b66162000000000000000000000000b4e16d0168e52d35cacd2c6185b44281ec28c9dc000000000000000000000000000000000000000000000000016345785d8a00007ffc00000000008200240344b4e16d0168e52d35cacd2c6185b44281ec28c9dc022c0d9f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000078787878787878787878787878787878787878780000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000028b7ffc000082002002006400e47858e59e0c01ea06df3af3d20ac7b0003275d4bf128acb080000000000000000000000000d4a11d5eeaac28ec3f61d100daf4d40471f18520000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000276a400000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000014a0b86991c6218b36c1d19d4a2e9eb0ce3606eb480000000000000000000000007ffb00000000000000000003082a007ffd0000000000820030004495b661620000000000000000000000000d4a11d5eeaac28ec3f61d100daf4d40471f185200000000000000000000000000000000000000000000000000000000000000007ffc000000000082002400a40d4a11d5eeaac28ec3f61d100daf4d40471f1852022c0d9f000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000007878787878787878787878787878787878787878000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000007ffc00000000000000000044c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2a9059cbb000000000000000000000000b4e16d0168e52d35cacd2c6185b44281ec28c9dc000000000000000000000000000000000000000000000000016345785d8a0000000000000000000000000000000000000000000000000000000000000000000000"
        ),
        bytes(
            hex"28472417000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000003f47ffd0000000000000000004495b66162000000000000000000000000b4e16d0168e52d35cacd2c6185b44281ec28c9dc000000000000000000000000000000000000000000000000016345785d8a00007ffc00000000008200240384b4e16d0168e52d35cacd2c6185b44281ec28c9dc022c0d9f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007878787878787878787878787878787878787878000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000002c87ffc000000000002006402447858e59e0c01ea06df3af3d20ac7b0003275d4bf128acb080000000000000000000000000d4a11d5eeaac28ec3f61d100daf4d40471f18520000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000276a400000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001787ffd0000000000020030004495b661620000000000000000000000000d4a11d5eeaac28ec3f61d100daf4d40471f185200000000000000000000000000000000000000000000000000000000000000007ffc000000000082002400a40d4a11d5eeaac28ec3f61d100daf4d40471f1852022c0d9f000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000007878787878787878787878787878787878787878000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000007ffc00000000001200440044a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48a9059cbb0000000000000000000000007858e59e0c01ea06df3af3d20ac7b0003275d4bf000000000000000000000000000000000000000000000000000000000000000000000000000000007ffc00000000000000000044c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2a9059cbb000000000000000000000000b4e16d0168e52d35cacd2c6185b44281ec28c9dc000000000000000000000000000000000000000000000000016345785d8a0000000000000000000000000000000000000000000000000000000000000000000000000000"
        ),
        bytes(
            hex"28472417000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000003f47ffd0000000000000000004495b66162000000000000000000000000b4e16d0168e52d35cacd2c6185b44281ec28c9dc000000000000000000000000000000000000000000000000016345785d8a00007ffc00000000008200240384b4e16d0168e52d35cacd2c6185b44281ec28c9dc022c0d9f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007878787878787878787878787878787878787878000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000002e07ffc00000000000200440044a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48a9059cbb0000000000000000000000003041cbd36888becc7bbcbc0045e3b1f144466f5f00000000000000000000000000000000000000000000000000000000000000007ffd0000000000020030004484f16ca00000000000000000000000003041cbd36888becc7bbcbc0045e3b1f144466f5f00000000000000000000000000000000000000000000000000000000000000007ffc000000000082004400a43041cbd36888becc7bbcbc0045e3b1f144466f5f022c0d9f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000007878787878787878787878787878787878787878000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000007ffc000082000082006400e411b815efb8f581194ae79006d24e0d814b7697f6128acb08000000000000000000000000787878787878787878787878787878787878787800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fffd8963efd1fc6a506488495d951d5263988d2500000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000014dac17f958d2ee523a2206206994597c13d831ec70000000000000000000000007ffc00000000000000000044c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2a9059cbb000000000000000000000000b4e16d0168e52d35cacd2c6185b44281ec28c9dc000000000000000000000000000000000000000000000000016345785d8a0000000000000000000000000000"
        ),
        bytes(
            hex"28472417000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004147ffd0000000000000000004495b66162000000000000000000000000b4e16d0168e52d35cacd2c6185b44281ec28c9dc000000000000000000000000000000000000000000000000016345785d8a00007ffc000000000082002403a4b4e16d0168e52d35cacd2c6185b44281ec28c9dc022c0d9f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007878787878787878787878787878787878787878000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000002fc7ffc00000000000200440044a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48a9059cbb0000000000000000000000003041cbd36888becc7bbcbc0045e3b1f144466f5f00000000000000000000000000000000000000000000000000000000000000007ffd0000000000020030004484f16ca00000000000000000000000003041cbd36888becc7bbcbc0045e3b1f144466f5f00000000000000000000000000000000000000000000000000000000000000007ffc000000000082004401c43041cbd36888becc7bbcbc0045e3b1f144466f5f022c0d9f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007878787878787878787878787878787878787878000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000001047ffc000082000002006400e411b815efb8f581194ae79006d24e0d814b7697f6128acb08000000000000000000000000787878787878787878787878787878787878787800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fffd8963efd1fc6a506488495d951d5263988d2500000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000014dac17f958d2ee523a2206206994597c13d831ec7000000000000000000000000000000000000000000000000000000000000000000000000000000007ffc00000000000000000044c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2a9059cbb000000000000000000000000b4e16d0168e52d35cacd2c6185b44281ec28c9dc000000000000000000000000000000000000000000000000016345785d8a000000000000000000000000000000000000"
        ),
        bytes(
            hex"28472417000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004147ffd0000000000000000004495b66162000000000000000000000000b4e16d0168e52d35cacd2c6185b44281ec28c9dc000000000000000000000000000000000000000000000000016345785d8a00007ffc000000000082002403a4b4e16d0168e52d35cacd2c6185b44281ec28c9dc022c0d9f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007878787878787878787878787878787878787878000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000002f07ffc00000000000200440044a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48a9059cbb0000000000000000000000003041cbd36888becc7bbcbc0045e3b1f144466f5f00000000000000000000000000000000000000000000000000000000000000007ffd0000000000020030004484f16ca00000000000000000000000003041cbd36888becc7bbcbc0045e3b1f144466f5f00000000000000000000000000000000000000000000000000000000000000007ffc000000000082004400a43041cbd36888becc7bbcbc0045e3b1f144466f5f022c0d9f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000d4a11d5eeaac28ec3f61d100daf4d40471f1852000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000007ffd0000000000820030004495b661620000000000000000000000000d4a11d5eeaac28ec3f61d100daf4d40471f185200000000000000000000000000000000000000000000000000000000000000007ffc000000000082002400a40d4a11d5eeaac28ec3f61d100daf4d40471f1852022c0d9f000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000007878787878787878787878787878787878787878000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000007ffc00000000000000000044c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2a9059cbb000000000000000000000000b4e16d0168e52d35cacd2c6185b44281ec28c9dc000000000000000000000000000000000000000000000000016345785d8a000000000000000000000000000000000000000000000000000000000000"
        ),
        bytes(
            hex"28472417000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004747ffd0000000000000000004495b66162000000000000000000000000b4e16d0168e52d35cacd2c6185b44281ec28c9dc000000000000000000000000000000000000000000000000016345785d8a00007ffc00000000008200240404b4e16d0168e52d35cacd2c6185b44281ec28c9dc022c0d9f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000078787878787878787878787878787878787878780000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000035c7ffc00000000000200440044a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48a9059cbb0000000000000000000000003041cbd36888becc7bbcbc0045e3b1f144466f5f00000000000000000000000000000000000000000000000000000000000000007ffd0000000000020030004484f16ca00000000000000000000000003041cbd36888becc7bbcbc0045e3b1f144466f5f00000000000000000000000000000000000000000000000000000000000000007ffc000000000082004402243041cbd36888becc7bbcbc0045e3b1f144466f5f022c0d9f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007878787878787878787878787878787878787878000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000001787ffc00000000000200440044dac17f958d2ee523a2206206994597c13d831ec7a9059cbb0000000000000000000000000d4a11d5eeaac28ec3f61d100daf4d40471f185200000000000000000000000000000000000000000000000000000000000000007ffd0000000000020030004495b661620000000000000000000000000d4a11d5eeaac28ec3f61d100daf4d40471f185200000000000000000000000000000000000000000000000000000000000000007ffc000000000082002400a40d4a11d5eeaac28ec3f61d100daf4d40471f1852022c0d9f0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000078787878787878787878787878787878787878780000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000007ffc00000000000000000044c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2a9059cbb000000000000000000000000b4e16d0168e52d35cacd2c6185b44281ec28c9dc000000000000000000000000000000000000000000000000016345785d8a000000000000000000000000000000000000"
        )
    ];

    function get_call_data(uint256 i) internal returns (bytes memory) {
        return callsdata[i];
    }

    function get_test_name(uint256 i) internal returns (string memory) {
        return testname[i];
    }

    function test_combo1() public {
        for (uint256 i = 0; i < callsdata.length; i++) {
            uint256 gasLeft = gasleft();
            uint256 balanceBefore = weth.balanceOf(address(multicaller));
            (bool result, ) = address(multicaller).call(get_call_data(i));
            uint256 gasUsed = gasLeft - gasleft();
            uint256 balanceUsed = balanceBefore -
                weth.balanceOf(address(multicaller));
            console.log(i, result, get_test_name(i), balanceBefore);
            if (
                balanceUsed >= 0.1 ether || gasUsed < 100000 || balanceUsed == 0
            ) {
                console.log(i, "failed");
                revert("failed");
            }
        }
    }

    function test_single() public {
        uint256 i = 11;
        uint256 gasLeft = gasleft();
        uint256 balanceBefore = weth.balanceOf(address(multicaller));
        (bool result, ) = address(multicaller).call(get_call_data(i));
        uint256 gasUsed = gasLeft - gasleft();
        uint256 balanceUsed = balanceBefore -
            weth.balanceOf(address(multicaller));
        console.log(i, result, get_test_name(i), balanceBefore);
    }

    function test_combo2() public {
        bytes[1] memory call_data = [
            bytes(
                hex"28472417000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000005047ffc000000000000000004e48ad599c3a0ff1de082011efddc58f1908eb6e6d8128acb080000000000000000000000003041cbd36888becc7bbcbc0045e3b1f144466f5f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000de0b6b3a7640000000000000000000000000000fffd8963efd1fc6a506488495d951d5263988d2500000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000004187ffd0000000000020030004484f16ca00000000000000000000000003041cbd36888becc7bbcbc0045e3b1f144466f5f00000000000000000000000000000000000000000000000000000000000000007ffc000000000082004403443041cbd36888becc7bbcbc0045e3b1f144466f5f022c0d9f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007878787878787878787878787878787878787878000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000002987ffc00000000000200440044dac17f958d2ee523a2206206994597c13d831ec7a9059cbb000000000000000000000000b20bd5d04be54f870d5c0d3ca85d82b34b83640500000000000000000000000000000000000000000000000000000000000000007ffd0000000000020030004495b66162000000000000000000000000b20bd5d04be54f870d5c0d3ca85d82b34b83640500000000000000000000000000000000000000000000000000000000000000007ffc000000000082002401c4b20bd5d04be54f870d5c0d3ca85d82b34b836405022c0d9f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007878787878787878787878787878787878787878000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000001047ffc000082002002006400e4c2e9f25be6257c210d7adf0d4cd6e3e881ba25f8128acb0800000000000000000000000078787878787878787878787878787878787878780000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000276a400000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000146b175474e89094c44da98b954eedeac495271d0f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007ffc00000000000000000044c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2a9059cbb0000000000000000000000008ad599c3a0ff1de082011efddc58f1908eb6e6d80000000000000000000000000000000000000000000000000de0b6b3a7640000000000000000000000000000000000000000000000000000000000000000000000000000"
            )
        ];

        for (uint256 i = call_data.length; i > 0; i--) {
            uint256 gasLeft = gasleft();
            uint256 balanceBefore = weth.balanceOf(address(multicaller));
            (bool result, ) = address(multicaller).call(call_data[i - 1]);
            uint256 gasUsed = gasLeft - gasleft();
            uint256 balanceAfter = weth.balanceOf(address(multicaller));
            uint256 balanceUsed = balanceBefore - balanceAfter;
            console.log(i, gasUsed, balanceAfter);
            if (balanceUsed >= 0.001 ether) {
                console.log(i, "failed");
            }
            assertEq(result, true);
        }
    }
}
